<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zhita.dao.manage.PostloanorderMapper">

		<resultMap id="OrderMap" type="com.zhita.model.manage.Orderdetails" >
		  <id column="orderDeatilId" property="orderDeatilId" jdbcType="INTEGER" />
		  <result column="name" property="name" jdbcType="VARCHAR"/>
		  <result column="phone" property="phone" jdbcType="VARCHAR"/>
		  <result column="orderId" property="orderId" jdbcType="INTEGER" />
		  <result column="realityBorrowMoney" property="realityBorrowMoney" jdbcType="DECIMAL" />
		  <result column="makeLoans" property="makeLoans" jdbcType="DECIMAL" />
		  <result column="borrowTimeLimit" property="borrowTimeLimit" jdbcType="VARCHAR" />
		  <result column="interestDay" property="interestDay" jdbcType="DECIMAL" />
		  <result column="interestSum" property="interestSum" jdbcType="DECIMAL" />
		  <result column="overdueNumberOfDays" property="overdueNumberOfDays" jdbcType="VARCHAR" />
		  <result column="interestPenaltyDay" property="interestPenaltyDay" jdbcType="DECIMAL" />
		  <result column="interestPenaltySum" property="interestPenaltySum" jdbcType="DECIMAL" />
		  <result column="interestInAll" property="interestInAll" jdbcType="DECIMAL" />
		  <result column="shouldReapyMoney" property="shouldReapyMoney" jdbcType="DECIMAL" />
		  <result column="repaymentPeriods" property="repaymentPeriods" jdbcType="VARCHAR" />
		  <result column="alreadyRepaymentPeriods" property="alreadyRepaymentPeriods" jdbcType="VARCHAR" />
		  <result column="shouldAlsoInterest" property="shouldAlsoInterest" jdbcType="DECIMAL"/>
		  <result column="rejectMonadCause" property="rejectMonadCause" jdbcType="VARCHAR" />
		  <result column="DrainageOfPlatform" property="DrainageOfPlatform" jdbcType="VARCHAR" />
		  <result column="registerClient" property="registerClient" jdbcType="VARCHAR" />
		  <result column="useBazaar" property="useBazaar" jdbcType="VARCHAR" />
		  <result column="deleted" property="deleted" jdbcType="VARCHAR" />
		  <result column="realtime" property="realtime" jdbcType="VARCHAR" />
		  <result column="borrowingtime" property="borrowingtime" jdbcType="VARCHAR" />
		  <result column="returntime" property="returntime" jdbcType="VARCHAR" />
		</resultMap>
		
		
		<select id="allOrderdetails" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select orde.*,u.name,u.phone,o.orderNumber,o.id,d.deferBeforeReturntime,d.interestOnArrears,d.postponeDate,d.deferAfterReturntime,
			defer.onceDeferredDay,defer.onceDeferredMoney,o.realtime,o.borrowMoneyWay,o.borrowTimeLimit
			 from orderdetails orde,user u,orders o,deferred d,deferred_settings defer
			<where>
			    AND o.shouldReturnTime &lt; #{returntime}
				AND o.userId = u.id 
				AND orde.orderId = o.id
				AND o.companyId = #{companyId}
				AND d.orderid = o.id
				AND defer.companyId = o.companyId
			</where>
			 order by orde.id desc
			limit #{page},#{pagesize}
		</select>



		
		<select id="totalCount" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from orderdetails ord,orders o
			<where>
				AND o.companyId = #{companyId}
			    AND o.shouldReturnTime &lt; #{returntime}
				<if test="realityBorrowMoney != null and realityBorrowMoney != ''">
					AND ord.realityBorrowMoney = #{realityBorrowMoney}
				</if>
				<if test="makeLoans != null and makeLoans != ''">
					AND ord.makeLoans = #{makeLoans}
				</if>
				<if test="shouldAlsoInterest != null and shouldAlsoInterest != ''">
					AND ord.shouldAlsoInterest = #{shouldAlsoInterest}
				</if>
				<if test="shouldReapyMoney != null and shouldReapyMoney != ''">
					AND ord.shouldReapyMoney = #{shouldReapyMoney}
				</if>
				<if test="borrowingtime != null and borrowingtime != ''">
					AND ord.borrowingtime = #{borrowingtime}
				</if>
				<if test="realtime != null and realtime != ''">
					AND ord.realtime = #{realtime}
				</if>
			</where>
		</select>




		<select id="allBeoverdueOrderdetails" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select orde.*,u.name,u.phone,o.orderNumber,o.id from orderdetails orde,user u,orders o 
			<where>
			    AND orde.returntime &lt; #{returntime}
				AND o.userId = u.id 
				AND orde.orderId = o.id
				AND o.companyId = #{companyId}
				<if test="realityBorrowMoney != null and realityBorrowMoney != ''">
					AND orde.realityBorrowMoney = #{realityBorrowMoney}
				</if>
				<if test="makeLoans != null and makeLoans != ''">
					AND orde.makeLoans = #{makeLoans}
				</if>
				<if test="shouldAlsoInterest != null and shouldAlsoInterest != ''">
					AND orde.shouldAlsoInterest = #{shouldAlsoInterest}
				</if>
				<if test="shouldReapyMoney != null and shouldReapyMoney != ''">
					AND orde.shouldReapyMoney = #{shouldReapyMoney}
				</if>
				<if test="borrowingtime != null and borrowingtime != ''">
					AND orde.borrowingtime = #{borrowingtime}
				</if>
				<if test="realtime != null and realtime != ''">
					AND orde.realtime = #{realtime}
				</if>
				<if test="borrowMoneyType != null and borrowMoneyType != ''">
					AND o.borrowMoneyType = #{borrowMoneyType}
				</if>
				<if test="orderId != null and orderId != ''">
					AND o.id = #{orderId}
				</if>
				<if test="name != '' and name != null">
					AND u.name = #{name}
				</if>
				<if test="phone != null and phone != ''">
					AND u.phone = #{phone}
				</if>
				<if test="borrowMoneyType != null and borrowMoneyType != ''">
					AND o.borrowMoneyType = #{borrowMoneyType}
				</if>
			</where>
			 order by orde.id desc
			limit #{page},#{pagesize}
		</select>
		
		
		
		
		<select id="BeoverduetotalCount" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from orderdetails or,orders o
			<where>
				AND o.companyId = #{companyId}
			    AND or.returntime &lt; #{returntime}
				<if test="realityBorrowMoney != null and realityBorrowMoney != ''">
					AND or.realityBorrowMoney = #{realityBorrowMoney}
				</if>
				<if test="makeLoans != null and makeLoans != ''">
					AND or.makeLoans = #{makeLoans}
				</if>
				<if test="shouldAlsoInterest != null and shouldAlsoInterest != ''">
					AND or.shouldAlsoInterest = #{shouldAlsoInterest}
				</if>
				<if test="shouldReapyMoney != null and shouldReapyMoney != ''">
					AND or.shouldReapyMoney = #{shouldReapyMoney}
				</if>
				<if test="borrowingtime != null and borrowingtime != ''">
					AND or.borrowingtime = #{borrowingtime}
				</if>
				<if test="realtime != null and realtime != ''">
					AND or.realtime = #{realtime}
				</if>
			</where>
		</select>
		
		
		
		<select id="SelectOrderDetails" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select orde.*,u.name,u.phone,o.orderNumber,o.id,d.deferBeforeReturntime,d.interestOnArrears,d.postponeDate,d.deferAfterReturntime,
			defer.onceDeferredDay,defer.onceDeferredMoney,o.realtime,o.borrowMoneyWay,o.borrowTimeLimit
			 from orderdetails orde,user u,orders o,deferred d,deferred_settings defer
			<where>
			    AND o.shouldReturnTime &gt; #{shouldReturnTime}
				AND o.userId = u.id 
				AND orde.orderId = o.id
				AND o.companyId = #{companyId}
				AND d.orderid = o.id
				AND defer.companyId = o.companyId
				AND o.id not in 
			<foreach collection="ids" item="id" open="(" separator="," close=")">
				#{id}
			</foreach>
			</where>
			group by o.id
			limit #{page},#{pagesize}
		</select>
		
		
		<select id="CollMemberId" parameterType="java.lang.Integer" resultType="java.lang.Integer">
			select collectionMemberId from collection_member where companyId = #{companyId}
		</select>
		
		
		<select id="SelectNodetId" parameterType="java.util.List" resultType="java.lang.Integer">
			select orderId from collection where collectionMemberId in 
			<foreach collection="ids" item="id" open="(" separator="," close=")">
				#{id}
			</foreach>
		</select>
		
		
		<select id="WeiNum" parameterType="java.lang.String" resultType="com.zhita.model.manage.Orderdetails">
			select count(orde.id) from orders o,orderdetails orde,user u where u.id = o.userId and orde.orderId = o.id
			and o.shouldReturnTime &gt; #{shouldReturnTime} and o.companyId = #{companyId}
		</select>
		
		
		
		<select id="OrderDetails" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select orde.*,u.name,o.orderNumber,o.id from orders o,orderdetails orde,user u,collection col
			<where>
			AND o.companyId = #{companyId}
			AND o.id in 
			<foreach collection="ids" item="id" open="(" separator="," close=")">
				#{id}
			</foreach>
			and u.id = o.userId 
			and orde.orderId = o.id
			and o.id = col.orderId
			and o.shouldReturnTime &gt; #{shouldReturnTime}
			<if test="orderId != null and orderId != ''">
				AND o.id = #{orderId}
			</if>
			<if test="name != null and name != ''">
				AND u.name = #{name}
			</if>
			<if test="phone != null and phone != ''">
				AND u.phone = #{phone}
			</if>
			<if test="collectionMemberId != null and collectionMemberId != ''">
				AND col.collectionMemberId = #{collectionMemberId}
			</if>
			</where>
			group by o.id 
			limit #{page},#{pagesize}
		</select>
		
		
		
		<select id="DateNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Collection">
			select DATE_FORMAT(collectionTime,'%Y-%m-%d') as collectionTime,count(collectionTime) as collection_count from collection
			<where>
				<if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
					AND collectionTime between #{statu_time} and#{end_time}
				</if>
			</where>
		</select>
		
		
		<select id="CollDateNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Collection">
			select DATE_FORMAT(ov.collectiondate,'%Y-%m-%d') as collectiondate,count(ov.overdue_id) as collection_count from overdue ov,collection_member c
			<where>
				AND c.collectionMemberId = ov.collectionMemberId
				AND c.companyId = #{companyId}
				<if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
					AND collectiondate between #{statu_time} and#{end_time}
				</if>
			</where>
			GROUP BY DATE_FORMAT(collectiondate,'%Y-%m-%d')
			limit #{page},#{pagesize}
		</select>
		
		
		
		
		<select id="MemberName" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Collection">
			select colme.collectionMemberId,colme.reallyName,DATE_FORMAT(ov.collectiondate,'%Y-%m-%d') as collectiondate,count(ov.collectiondate) as collection_count 
			from overdue ov,collection_member colme
			<where>
				AND colme.companyId = #{companyId}
				AND ov.collectionMemberId = colme.collectionMemberId 
				<if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
					AND collectionTime between #{statu_time} and#{end_time}
				</if>
			</where>
			GROUP BY ov.collectionMemberId
			limit #{page},#{pagesize}
		</select>
		
		
		<select id="MemberNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Collection">
			select colme.reallyName,DATE_FORMAT(ov.collectiondate,'%Y-%m-%d') as collectiondate,count(ov.collectiondate) as collection_count from 
			overdue ov,collection_member colme
			<where>
				AND ov.collectionMemberId = colme.collectionMemberId 
				<if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
					AND collectionTime between #{statu_time} and#{end_time}
				</if>
			</where>
		</select>
		
		
		
		<select id="MyOrderdue" resultType="com.zhita.model.manage.Orderdetails" parameterType="com.zhita.model.manage.Orderdetails">
			select o.id,o.orderNumber,u.name,u.phone,o.borrowMoneyWay,o.borrowTimeLimit,o.orderCreateTime,ord.realityBorrowMoney,ord.makeLoans,
			defe.deferBeforeReturntime,defe.interestOnArrears,ord.realityAccount,deset.onceDeferredDay,defe.deferAfterReturntime,colme.reallyName,
			col.collectionTime,col.collectionStatus,o.orderStatus,ovd.overdue_id
			from orders o,orderdetails ord,collection col,collection_member colme,deferred defe,deferred_settings deset,user u,overdue ovd
			<where>
				AND o.id = ord.orderId
				AND u.id = o.userId
				AND colme.collectionMemberId = col.collectionMemberId
				AND o.id = col.orderId
				AND o.id = defe.orderid
				AND o.companyId = deset.companyId 
				AND o.companyId = #{companyId}
				AND col.collectionMemberId = #{collectionMemberId}
			</where>
			GROUP BY o.id
				limit #{page},#{pagesize}
		</select>
		
		
		
		<select id="MyOrderNum" resultType="com.zhita.model.manage.Orderdetails" parameterType="java.lang.Integer">
			select count(*) from overdue where collectionMemberId = #{collectionMemberId}
		</select>


		<update id="OverdueStatu" parameterType="com.zhita.model.manage.Orderdetails">
			update overdue set overdue_phonestaus=#{overdue_phonestaus} where overdue_id = #{overdue_id}
		</update>
		
		
		<insert id="AddOverdue" parameterType="com.zhita.model.manage.Overdue">
			INSERT INTO `Overdue`(
			overdue_phonestaus,
			collectionMemberId,
			collectiondate,
			orderId
			)
			VALUES
			(#{overdue_phonestaus},#{collectionMemberId},#{collectiondate},#{orderId})
		</insert>
		
		
		<select id="connectedNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select Count(*) from overdue 
			<where>
				AND overdue_phonestaus = #{overdue_phonestaus}
				AND collectiondate = #{collectionTime}
				AND collectionMemberId in
				<foreach collection="ids" item="id" open="(" separator="," close=")">
					#{id}
				</foreach>
				<if test="collectiondate != null and collectiondate != ''">
					AND collectiondate = #{collectiondate}				
				</if>
			</where>
		</select>
		
		
		<select id="OrderIdNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from orders 
			<where>
				AND companyId = #{companyId}
			</where> 
		</select>
		
		
		<select id="OverIdNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(orderId) from overdue 
			<where>
			 AND collectionMemberId in
			<foreach collection="ids" item="id" open="(" separator="," close=")">
				#{id}
			</foreach>
			<if test="collectiondate != null and collectiondate != ''">
				AND collectiondate = #{collectiondate}
			</if>
			</where>
			GROUP BY orderId
		</select>
		
		
		<select id="StatusOrders" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from overdue where collectiondate = #{collectiondate}
			and statu = #{statu}
			AND collectiondate = #{collectionTime}
			AND collectionMemberId in
				<foreach collection="ids" item="id" open="(" separator="," close=")">
					#{id}
				</foreach>
		</select>
		
		
		
		<select id="AOrderDetails" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select o.orderNumber,u.name,u.phone,o.borrowMoneyWay,o.orderCreateTime,ord.realityBorrowMoney,ord.makeLoans,
			defe.deferBeforeReturntime,defe.interestOnArrears,ord.realityAccount,deset.onceDeferredDay,defe.deferAfterReturntime,colme.reallyName,
			col.collectionTime,col.collectionStatus,o.orderStatus,o.borrowTimeLimit
			from orders o,orderdetails ord,collection col,collection_member colme,deferred defe,deferred_settings deset,user u
			<where>
				AND o.id = ord.orderId
				AND u.id = o.userId
				AND colme.collectionMemberId = col.collectionMemberId
				AND o.id = col.orderId
				AND o.id = defe.orderid
				AND o.companyId = deset.companyId
				AND o.companyId = #{companyId}
				<if test="orderNumber != null and orderNumber != ''">
					AND o.orderNumber = #{orderNumber}
				</if>
				<if test="name != null and name != ''">
					AND u.name = #{name}
				</if>
				<if test="phone != null and phone != ''">
					AND u.phone = #{phone}
				</if>
				<if test="collectionMemberId != null and collectionMemberId != ''">
					AND col.collectionMemberId = #{collectionMemberId}
				</if>
			</where>
			group by o.id
			limit #{page},#{pagesize}
		</select>
		
		
		
		
		<select id="UserDianlNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from overdue 
			<where>
			 AND collectionMemberId = #{collectionMemberId} 
			 and collectiondate = #{collectiondate}
			 AND trim(overdueNumberOfDays)!=''
			</where>
		</select>
		
		
		<select id="UserNumOrder" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from overdue 
			<where>
			 AND collectionMemberId = #{collectionMemberId} 
			 and collectiondate = #{collectiondate}
			</where>
		</select>
		
		
		<select id="Userphonestaus" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(*) from overdue 
			<where>
			 AND collectionMemberId = #{collectionMemberId} 
			 AND collectiondate = #{collectiondate}
			AND overdue_phonestaus = #{overdue_phonestaus}
			</where>
		</select>
		
		
		<select id="UserOrderStatu" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(ov.overdue_id) from overdue ov,orders o
			<where>
				AND ov.orderId = o.id
				AND o.orderStatus != #{orderStatus}
				AND ov.collectiondate = #{collectiondate}
				AND ov.collectionMemberId = #{collectionMemberId}
			</where>
		</select>
		
		
		
		
		<select id="YiHuanOrdersTotalCount" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(o.id) from orders o,user u
			<where>
			 AND u.id = o.userId
			 AND o.orderStatus = #{orderStatus} 
			 AND o.companyId = #{companyId}
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="overdueGrade != null and overdueGrade != ''">
			 	AND o.overdueGrade = #{overdueGrade}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="orderStatus != null and orderStatus != ''">
			 	AND o.orderStatus = #{orderStatus}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			 </where>
		</select>
		
		
		<select id="YiHuanOrders" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select o.orderNumber,u.name,u.phone,ord.DrainageOfPlatform,o.borrowMoneyWay,o.borrowTimeLimit,o.orderCreateTime,ord.realityBorrowMoney,
			ord.makeLoans,defe.deferBeforeReturntime,deset.onceDeferredDay,defe.deferAfterReturntime,defe.interestOnArrears,c.collectionStatus,o.realtime,
			ord.overdueNumberOfDays,ord.interestPenaltySum,o.realtime,ord.surplus_money,defe.interestOnArrears,colme.reallyName
			 from orders o,user u,orderdetails ord,deferred defe,deferred_settings deset,collection_member colme,collection c
			<where>
			 AND u.id = o.userId
			 AND o.id = ord.orderId
			 AND o.id = defe.orderid
			 AND o.id = c.orderId
			 AND colme.collectionMemberId = c.collectionMemberId
			 AND o.companyId = deset.companyId
			 AND o.orderStatus = #{orderStatus} 
			 AND o.companyId = #{companyId}
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="overdueGrade != null and overdueGrade != ''">
			 	AND o.overdueGrade = #{overdueGrade}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			 </where>
			 limit #{page},#{pagesize}
		</select>
		
		
		
		
		<select id="CollecOrdersTotalCount" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(o.id) from orders o,user u
			<where>
			 AND u.id = o.userId
			 AND o.orderStatus = "1" 
			 AND o.companyId = #{companyId}
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="orderStatus != null and orderStatus != ''">
			 	AND o.orderStatus = #{orderStatus}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			 <if test="overdueGrade != null and overdueGrade != ''">
			 	AND o.overdueGrade = #{overdueGrade}
			 </if>
			</where>
		</select>
		
		
		
		
		<select id="CollecOrders" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select o.orderNumber,u.name,u.phone,ord.DrainageOfPlatform,o.borrowMoneyWay,o.borrowTimeLimit,ord.realityBorrowMoney,ord.makeLoans,
			defe.deferBeforeReturntime,deset.onceDeferredDay,defe.deferAfterReturntime,o.canDeferNumberoftime,defe.interestOnArrears,o.overdueGrade,
			ord.overdueNumberOfDays,ord.interestPenaltySum,ord.realityBorrowMoney,c.collectionStatus,o.realtime,colme.reallyName,ord.overdueNumberOfDays,o.orderCreateTime
			from orders o,user u,orderdetails ord,deferred defe,deferred_settings deset,collection_member colme,collection c
			<where>
			 AND u.id = o.userId
			 AND o.id = ord.orderId
			 AND o.id = defe.orderid
			  AND o.id = c.orderId
			 AND colme.collectionMemberId = c.collectionMemberId
			 AND o.companyId = deset.companyId
			 AND o.orderStatus = "1" 
			 AND o.companyId = #{companyId}
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="orderStatus != null and orderStatus != ''">
			 	AND o.orderStatus = #{orderStatus}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			 <if test="overdueGrade != null and overdueGrade != ''">
			 	AND o.overdueGrade = #{overdueGrade}
			 </if>
			</where>
			limit #{page},#{pagesize}
		</select>
		
		
		<select id="Phone_num" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(c.collectionId) from orders o,collection c where c.orderId = o.id and o.companyId = #{companyId} and c.orderId = #{orderId}
		</select>
		
		
		
		<select id="HuaiZhangOrdersTotalCount" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(c.collectionId) from orders o,collection c,user u,blacklist_user bl,whitelist_user wh
			<where>
				 AND wh.phone = u.phone
				 AND u.id = o.userId
				 AND c.orderId = o.id
				 AND o.companyId = #{companyId}
				 AND bl.userId = u.id
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="orderStatus != null and orderStatus != ''">
			 	AND o.orderStatus = #{orderStatus}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			<if test="overdueGrade != null and overdueGrade != ''">
				AND ord.overdueGrade = #{overdueGrade}
			</if>
			</where>
		</select>
		
		
		
		<select id="HuaiZhangOrders" parameterType="com.zhita.model.manage.Orderdetails" resultType="com.zhita.model.manage.Orderdetails">
			select o.id,o.orderNumber,u.name,u.phone,ord.DrainageOfPlatform,o.borrowMoneyWay,o.borrowTimeLimit,
			o.orderCreateTime,ord.realityBorrowMoney, ord.makeLoans,defe.deferBeforeReturntime,deset.onceDeferredDay,
			defe.deferAfterReturntime,defe.interestOnArrears, o.overdueGrade,ord.overdueNumberOfDays,c.collectionStatus,o.realtime,colme.reallyName
			 from orders o,collection c,user u,orderdetails ord,deferred defe,deferred_settings deset,collection_member colme
			<where>
				AND c.orderId = o.id
				AND c.collectionMemberId = colme.collectionMemberId
				AND c.collectionStatus = "态度恶劣"
				 AND u.id = o.userId
				 AND c.orderId = o.id
				 AND o.companyId = #{companyId}
			 <if test="name != null and name != ''">
			 	AND name = #{name}
			 </if>
			 <if test="phone != null and phone != ''">
			 	AND u.phone = #{phone}
			 </if>
			 <if test="orderNumber != null and orderNumber != ''">
			 	AND o.orderNumber = #{orderNumber}
			 </if>
			 <if test="orderStatus != null and orderStatus != ''">
			 	AND o.orderStatus = #{orderStatus}
			 </if>
			 <if test="start_time != null and statu_time != '' and end_time != null and end_time != ''">
				AND o.orderCreateTime between #{statu_time} and#{end_time}
			</if>
			<if test="overdueGrade != null and overdueGrade != ''">
				AND ord.overdueGrade = #{overdueGrade}
			</if>
			</where>
			group by o.id
			limit #{page},#{pagesize}
		</select>
		
		
		
		
		<select id="OrderDefeNum" parameterType="com.zhita.model.manage.Orderdetails" resultType="java.lang.Integer">
			select count(id) from deferred where orderid = #{orderId}
		</select>
</mapper>